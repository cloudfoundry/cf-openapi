/v3/service_brokers:
  get:
    summary: List service brokers
    description: This endpoint retrieves the service brokers the user has access to.
    operationId: listServiceBrokers
    tags:
      - Service Brokers
    parameters:
      - $ref: ../components/parameters/Page.yaml
      - $ref: ../components/parameters/PerPage.yaml
      - $ref: ../components/parameters/OrderBy.yaml
      - name: names
        in: query
        schema:
          type: array
          items:
            type: string
        description: Comma-delimited list of service broker names to filter by
      - name: space_guids
        in: query
        schema:
          type: array
          items:
            type: string
        description: Comma-delimited list of space guids to filter by
      - $ref: ../components/parameters/LabelSelector.yaml
      - $ref: ../components/parameters/CreatedAts.yaml
      - $ref: ../components/parameters/UpdatedAts.yaml
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              $ref: ../components/schemas/ServiceBrokerList.yaml
      '401':
        $ref: ../components/responses/Unauthorized.yaml
  post:
    summary: Create a service broker
    description: |-
      This endpoint creates a new service broker and a job to synchronize the service offerings and service plans with those in the broker's catalog.
      The `Location` header refers to the created job which syncs the broker with the catalog. See [Jobs](#/components/schemas/job) for more information and limitations.
    operationId: createServiceBroker
    tags:
      - Service Brokers
    requestBody:
      content:
        application/json:
          schema:
            $ref: ../components/schemas/ServiceBroker.yaml
    responses:
      '202':
        description: Accepted
        headers:
          Location:
            description: URL of the job that is creating the service broker
            schema:
              type: string
              format: uri
        content:
          application/json:
            schema:
              $ref: ../components/schemas/Job.yaml
      '401':
        $ref: ../components/responses/Unauthorized.yaml
      '422':
        $ref: ../components/responses/UnprocessableEntity.yaml
/v3/service_brokers/{guid}:
  get:
    summary: Get a service broker
    description: This endpoint retrieves the service broker by GUID.
    operationId: getServiceBroker
    tags:
      - Service Brokers
    parameters:
      - $ref: ../components/parameters/Guid.yaml
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              $ref: ../components/schemas/ServiceBroker.yaml
      '401':
        $ref: '../components/responses/Unauthorized.yaml'
      '404':
        $ref: ../components/responses/NotFound.yaml
  patch:
    summary: Update a service broker
    description: |-
      This endpoint updates a service broker. Depending on the parameters specified,
      the endpoint may respond with a background job, and it may synchronize the
      service offerings and service plans with those in the broker's catalog. When a service broker has a synchronization job in progress, only
      updates with `metadata` are permitted until the synchronization job
      is complete.
    operationId: updateServiceBroker
    tags:
      - Service Brokers
    parameters:
      - $ref: ../components/parameters/Guid.yaml
    requestBody:
      content:
        application/json:
          schema:
            $ref: ../components/schemas/ServiceBroker.yaml
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              $ref: ../components/schemas/ServiceBroker.yaml
      '202':
        description: Accepted
        headers:
          Location:
            description: URL of the job that is updating the service broker
            schema:
              type: string
              format: uri
        content:
          application/json:
            schema:
              $ref: ../components/schemas/Job.yaml
      '401':
        $ref: '../components/responses/Unauthorized.yaml'
      '404':
        $ref: ../components/responses/NotFound.yaml
      '422':
        $ref: ../components/responses/UnprocessableEntity.yaml
  delete:
    summary: Delete a service broker
    description: This endpoint creates a job to delete an existing service broker. The `Location` header refers to the created job. See [Jobs](#/components/schemas/job) for more information and limitations.
    operationId: deleteServiceBroker
    tags:
      - Service Brokers
    parameters:
      - $ref: ../components/parameters/Guid.yaml
    responses:
      '202':
        description: Accepted
        headers:
          Location:
            description: URL of the job that is deleting the service broker
            schema:
              type: string
              format: uri
        content:
          application/json:
            schema:
              $ref: ../components/schemas/Job.yaml
      '401':
        $ref: '../components/responses/Unauthorized.yaml'
      '404':
        $ref: ../components/responses/NotFound.yaml

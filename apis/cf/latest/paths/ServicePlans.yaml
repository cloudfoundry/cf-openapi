/v3/service_plans:
  get:
    summary: List service plans
    description: This endpoint retrieves the service plans the user has access to.
    operationId: listServicePlans
    tags:
      - Service Plans
    parameters:
      - $ref: ../components/parameters/Page.yaml
      - $ref: ../components/parameters/PerPage.yaml
      - $ref: ../components/parameters/OrderBy.yaml
      - name: names
        in: query
        schema:
          type: array
          items:
            type: string
        description: Comma-delimited list of service plan names to filter by
      - name: available
        in: query
        schema:
          type: boolean
        description: Filter by the `available` property; valid values are `true` or `false`
      - name: service_offering_guids
        in: query
        schema:
          type: array
          items:
            type: string
        description: Comma-delimited list of service offering guids to filter by
      - name: service_instance_guids
        in: query
        schema:
          type: array
          items:
            type: string
        description: Comma-delimited list of service instance guids to filter by
      - name: space_guids
        in: query
        schema:
          type: array
          items:
            type: string
        description: Comma-delimited list of space guids to filter by
      - name: organization_guids
        in: query
        schema:
          type: array
          items:
            type: string
        description: Comma-delimited list of organization guids to filter by
      - name: broker_catalog_ids
        in: query
        schema:
          type: array
          items:
            type: string
        description: Comma-delimited list of broker catalog IDs to filter by
      - name: service_broker_guids
        in: query
        schema:
          type: array
          items:
            type: string
        description: Comma-delimited list of service broker GUIDs to filter by
      - name: service_broker_names
        in: query
        schema:
          type: array
          items:
            type: string
        description: Comma-delimited list of service broker names to filter by
      - name: service_offering_names
        in: query
        schema:
          type: array
          items:
            type: string
        description: Comma-delimited list of service offering names to filter by
      - name: include
        in: query
        schema:
          type: array
          items:
            type: string
        description: Comma-delimited list of resource names to include in the response
      - $ref: ../components/parameters/LabelSelector.yaml
      - name: fields
        in: query
        schema:
          type: object
        description: Fields to include in the response
      - $ref: ../components/parameters/CreatedAts.yaml
      - $ref: ../components/parameters/UpdatedAts.yaml
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              $ref: ../components/schemas/ServicePlanList.yaml
      '401':
        $ref: ../components/responses/Unauthorized.yaml
/v3/service_plans/{guid}:
  get:
    summary: Get a service plan
    description: This endpoint retrieves the service plan by GUID.
    operationId: getServicePlan
    tags:
      - Service Plans
    parameters:
      - $ref: ../components/parameters/Guid.yaml
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              $ref: ../components/schemas/ServicePlan.yaml
      '401':
        $ref: '../components/responses/Unauthorized.yaml'
      '404':
        $ref: ../components/responses/NotFound.yaml
  patch:
    summary: Update a service plan
    description: This endpoint updates a service plan with labels and annotations.
    operationId: updateServicePlan
    tags:
      - Service Plans
    parameters:
      - $ref: ../components/parameters/Guid.yaml
    requestBody:
      content:
        application/json:
          schema:
            properties:
              metadata:
                $ref: ../components/schemas/Metadata.yaml
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              $ref: ../components/schemas/ServicePlan.yaml
      '401':
        $ref: '../components/responses/Unauthorized.yaml'
      '404':
        $ref: ../components/responses/NotFound.yaml
      '422':
        $ref: ../components/responses/UnprocessableEntity.yaml
  delete:
    summary: Delete a service plan
    description: |-
      This endpoint deletes a service plan. This is used to remove service plans from the Cloud Foundry database when they
      are no longer provided by the service broker.
    operationId: deleteServicePlan
    tags:
      - Service Plans
    parameters:
      - $ref: ../components/parameters/Guid.yaml
    responses:
      '204':
        description: No Content
      '401':
        $ref: '../components/responses/Unauthorized.yaml'
      '404':
        $ref: ../components/responses/NotFound.yaml
/v3/service_plans/{guid}/visibility:
  get:
    summary: Get a service plan visibility
    description: This endpoint retrieves the service plan visibility for a given plan.
    operationId: getServicePlanVisibility
    tags:
      - Service Plans
    parameters:
      - $ref: ../components/parameters/Guid.yaml
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              $ref: ../components/schemas/ServicePlanVisibility.yaml
      '401':
        $ref: '../components/responses/Unauthorized.yaml'
      '404':
        $ref: ../components/responses/NotFound.yaml
  patch:
    summary: Update a service plan visibility
    description: This endpoint updates a service plan visibility. It behaves similar to the `POST` endpoint but this endpoint will replace the existing list of organizations when the service plan is `organization` visible.
    operationId: updateServicePlanVisibility
    tags:
      - Service Plans
    parameters:
      - $ref: ../components/parameters/Guid.yaml
    requestBody:
      content:
        application/json:
          schema:
            $ref: ../components/schemas/ServicePlanVisibility.yaml
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              $ref: ../components/schemas/ServicePlanVisibility.yaml
      '401':
        $ref: '../components/responses/Unauthorized.yaml'
      '404':
        $ref: ../components/responses/NotFound.yaml
      '422':
        $ref: ../components/responses/UnprocessableEntity.yaml
  post:
    summary: Apply a service plan visibility
    description: This endpoint applies a service plan visibility. It behaves similar to the `PATCH` endpoint but this endpoint will append to the existing list of organizations when the service plan is `organization` visible.
    operationId: applyServicePlanVisibility
    tags:
      - Service Plans
    parameters:
      - $ref: ../components/parameters/Guid.yaml
    requestBody:
      content:
        application/json:
          schema:
            $ref: ../components/schemas/ServicePlanVisibility.yaml
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              $ref: ../components/schemas/ServicePlanVisibility.yaml
      '401':
        $ref: '../components/responses/Unauthorized.yaml'
      '404':
        $ref: ../components/responses/NotFound.yaml
      '422':
        $ref: ../components/responses/UnprocessableEntity.yaml
/v3/service_plans/{guid}/visibility/{organization_guid}:
  delete:
    summary: Remove organization from a service plan visibility
    description: This endpoint removes an organization from a service plan visibility list of organizations. It is only defined for service plans which are org-restricted. It will fail with a HTTP status code of 422 for any other visibility type (e.g. Public).
    operationId: removeOrganizationFromServicePlanVisibility
    tags:
      - Service Plans
    parameters:
      - $ref: ../components/parameters/Guid.yaml
      - name: organization_guid
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '204':
        description: No Content
      '401':
        $ref: '../components/responses/Unauthorized.yaml'
      '404':
        $ref: ../components/responses/NotFound.yaml

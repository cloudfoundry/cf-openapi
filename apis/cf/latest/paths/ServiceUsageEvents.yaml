/v3/service_usage_events:
  get:
    summary: List service usage events
    description: Retrieve all service usage events the user has access to.
    operationId: listServiceUsageEvents
    tags:
      - Service Usage Events
    parameters:
      - $ref: ../components/parameters/Page.yaml
      - $ref: ../components/parameters/PerPage.yaml
      - $ref: ../components/parameters/OrderBy.yaml
      - $ref: ../components/parameters/CreatedAts.yaml
      - name: after_guid
        in: query
        description: Filters out events before and including the event with the given guid.
        schema:
          type: string
      - name: guids
        in: query
        description: Comma-delimited list of usage event guids to filter by.
        schema:
          type: array
          items:
            type: string
      - name: service_instance_types
        in: query
        description: Comma-delimited list of service instance types to filter by; valid values are `managed` and `user-provided`
        schema:
          type: array
          items:
            type: string
      - name: service_offering_guids
        in: query
        description: Comma-delimited list of service offering guids to filter by
        schema:
          type: array
          items:
            type: string
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              $ref: ../components/schemas/ServiceUsageEventList.yaml
      '401':
        $ref: ../components/responses/Unauthorized.yaml
/v3/service_usage_events/{guid}:
  get:
    summary: Get a service usage event
    description: Retrieve a service usage event.
    operationId: getServiceUsageEvent
    tags:
      - Service Usage Events
    parameters:
      - $ref: ../components/parameters/Guid.yaml
    responses:
      '200':
        description: OK
        content:
          application/json:
            schema:
              $ref: ../components/schemas/ServiceUsageEvent.yaml
      '404':
        $ref: ../components/responses/NotFound.yaml
/v3/service_usage_events/actions/destructively_purge_all_and_reseed:
  post:
    summary: Purge and seed service usage events
    description: Destroys all existing events. Populates new usage events, one for each existing service instance. All populated events will have a `created_at` value of current time. There is the potential race condition if service instances are currently being created or deleted. The seeded usage events will have the same guid as the service instance.
    operationId: purgeAndSeedServiceUsageEvents
    tags:
      - Service Usage Events
    responses:
      '202':
        description: Accepted
      '404':
        $ref: '../components/responses/NotFound.yaml'
        content:
          application/json:
            schema:
              $ref: ../components/schemas/Job.yaml
